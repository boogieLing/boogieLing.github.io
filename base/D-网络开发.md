# 网络开发

## 负载均衡算法

**1.轮询**

将所有请求依次分发到每台服务器。

适合服务器硬件相同的场景。

优点：服务器的请求都会相同。

缺点：请求数相同，但服务器各自的压力不一样，所以不适用于服务器配置不一样的场景。

**2.随机**

随机分发请求到各台服务器，**外加一个计数器保证都发过了。**

优点：简单。

缺点：不适用于服务器配置不一样的场景，算法性能能证明但不可保证。

**3.最少链接**

将请求分配到连接数最少的服务器上（目前请求最少的服务器）

优点：动态，能根据当前服务器的请求情况做出应对。

缺点：需要监听请求数，这会增加额外开销，算法实现复杂。

**4.Hash法**

将客户端的IP通过哈希映射出一个数值，将该数值对服务器列表大小进行取模。

如此一来，在后端服务器列表不变的情况下同一个IP每次请求的服务器都不会改变。

优点：在同一会话期，能够实现窗口粘滞。

缺点：如果该服务器宕机，那么会话会丢失，不进行处理的话就会一直请求失败。

**5.加权**

以上算法都能进行加权优化，提高负载小、配置高的服务器权重，降低负载大、配置低的服务器权重。

优点：更好地平衡请求的数目。

缺点：算法复杂。

------

## CDN

内容分发网络，缓存服务器

就是在客户端和服务器之间加了一个缓存区。

CDN系统可以实时地根据 **网络流量和各节点的连接**、**负载状况**、**与各用户的距离以及响应时间** 等综合信息来 **重定向用户的请求** 到最快最近的服务节点上。

是一个整体系统，包括分布式存储、负载均衡、网络请求重定向、内容管理。

核心是内容管理和网络流量管理。

工作流程：

![img](https://pic1.zhimg.com/50/79c1abc468349073fb433d0949423717_hd.jpg)

![img](https://pic2.zhimg.com/50/049b124feb55100ff2f147b768ad4c8b_hd.jpg)

无CDN：

![img](https://pic4.zhimg.com/80/f9708de32d641358e47edc96307775d5_hd.jpg)

------

